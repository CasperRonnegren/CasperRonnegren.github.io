<!DOCTYPE HTML>
<html>
<head>
    <title>Casper Portfolio</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
</head>
<body class="is-preload">
<div id="page-wrapper">

    <!-- Header -->
    <header id="header">
        <h1 id="logo"><a href="index.html">< Portfolio</a></h1>
        <nav id="nav">
        </nav>
    </header>

    <!-- Main -->
    <div id="main" class="wrapper style1">
        <div class="container">
            <header class="major"><h2>Low-Level Multiplayer</h2></header>

            <!-- Introduction -->
            <div class="row gtr-150">
                <div class="col-12 col-12-medium">
                    <b class="image fit" style="background-color: #12151e ;"><img src="images/Multi/Multi_Game.jpg" alt="" style="width: 80%; margin-left: auto; margin-right: auto"/></b>
                </div>
                <div class="col-12 col-12-medium">
                    <h3>Introduction</h3>
                    <p style="margin-bottom: 0">
                        For this project, me and a classmate decided to make a simple multiplayer game for the course we were taking.
                        I refer to it as simple, but that is because the gameplay that was designed to be simple whereas the underlying architecture ended up being a bit more complicated.
                        Originally, we used Unity's high-level networking library, <a href="https://docs.unity3d.com/Packages/com.unity.netcode.gameobjects@2.4/manual/index.html">Netcode for GameObjects</a>, 
                        to make the game.
                        However, we quickly encountered a problem, which was that we finished the game within the first week.
                        As the deadline was a bit more than a month away, we decided to switch to using Unity's low-level networking library,
                        <a href="https://docs.unity3d.com/Packages/com.unity.transport@2.5/manual/index.html">Unity Transport</a>, which proved to be significantly more of a challenge.
                    </p>
                </div>
                <div class="col-12 col-12-medium"><hr/></div>
            </div>

            <!-- Gameplay -->
            <div class="row gtr-150">
                <div class="col-12 col-12-medium">
                    <h3>Gameplay</h3>
                    <p style="margin-bottom: 0">
                        As mentioned, the gameplay is quite simple. 
                        The focus of the project was the underlying multiplayer architecture, 
                        so I tried coming up with an idea for a game where multiplayer itself is essential, but the development time required for non-multiplayer aspects would be kept minimal.
                        The goal of the game is for two players to cooperate in order to move upwards until a progress bar fills up.
                        To progress upwards, players can jump, move to the left or right, and shoot "shapes" in the direction of their cursor by left-clicking.
                        A shape shot by a player stops in place once they press left-click again.
                        The problem the players face is that they are divided by a barrier (the yellow area), and cannot stop shapes in place on their side of the barrier as doing so destroys the shape.
                        Thus, to progress upwards, the players have to cooperate by shooting shapes over to each other that can be used as platforms.
                        For added difficulty, we made the shapes randomized and only allow two shapes in place at once for each player.
                    </p>
                </div>
                <div class="col-12 col-12-medium"><hr/></div>
            </div>

            <!-- Architecture -->
            <div class="row gtr-150">
                <div class="col-12 col-12-medium">
                    <h3>Architecture</h3>
                    <p>
                        Multiplayer in the game was built through the low-level networking library Unity Transport.
                        To give a better perspective of what that means, we used Transport set up player connections, manage them, and to create packages to be sent between them.
                        In conjunction with Transport, we also used <a href="https://docs.unity.com/ugs/en-us/manual/relay/manual/introduction">Unity Relay</a> to establish connections over the web.
                        Relay acts as a proxy between the players and host and is useful as it deals with problems like changing networks and IP addresses, Network Address Translation (NAT), and firewalls between players.
                        In addition to the relay solution which works over the web, we did also manage to set up a LAN solution solely through Transport.
                    </p>
                </div>
                <div class="col-6 col-12-medium"><b class="image fit"><img src="images/Multi/Multi_Lobby.jpg" alt="" /></b></div>
                <div class="col-6 col-12-medium"><b class="image fit"><img src="images/Multi/Multi_Players.jpg" alt="" /></b></div>
                <div class="col-12 col-12-medium">
                    <p>
                        We began our work by solving the problem the rest of our work would come to depend on: sending data from one player to another.
                        Fortunately, this wasn't too difficult as the documentation shows how to create a simple client and server, and how to send packages between them.
                        It's after this point that the work got a lot more interesting as we had to begin figuring out how to do a lot of stuff ourselves.
                        This is because, while there are a lot of resources out there that explain networking concepts and what stuff like what UDP packages are, 
                        when it came to how to actually utilize them to create stuff like games, we didn't really find any.
                    </p>
                    <p>
                        The first thing we did from this point was set up a system for how packages containing different types of data for different parts of the game should be managed as I 
                        realized that it would become a growing problem if we didn't deal with it early on.
                        We set it up as such that the first piece of data in every package is an integer which is used as an identifier for how the rest of the package is supposed to be read.
                        In the code, this is simply a switch which leads to different functions.
                    </p>
                    <p>
                        From this point on, most of the work was just to set up the game by creating protocols for how to write or read packages.
                        That itself was an interesting experience as we had to figure out how to properly synchronize different types of data between the host and clients.
                        We had to think about questions such as if everything should update on the host's side before being updated for clients, or if it was okay for clients to have something
                        change on their side immediately before sending the update to the host which would then send the update to remaining clients.
                        We also took into consideration how often we had to update data.
                        While we could stuff like continuously updating an object we've designated to be synchronized over the network, it only really needs to be done when the object itself moves.
                        Additionally, while the game itself is designed for only two players, we did a bunch of testing to ensure everything would work for a larger amount of players as we
                        wanted to thoroughly learn how to set up multiplayer.
                    </p>
                    <p style="margin-bottom: 0">
                        Eventually, as the game got closer to being done, me and my classmate decided that I would try to create a solution to establish connections instead of using
                        Unity Relay  while they worked on finishing up the game.
                        Unfortunately, due to Port Forwarding not working on my router, which is a problem I've had in the past, I wasn't able to create a solution that worked over the web
                        within the time remaining for the course.
                        However, during the process, I ended up learning a lot about network programming in general and was able to create solution that works over LAN.
                        As such, we made it possible to choose in the game whether one wants to play locally using that solution, or over the web using Relay.
                    </p>
                </div>
            </div>
            <div class="col-12 col-12-medium"><hr/></div>
            
            <!-- Learn -->
            <div class="row gtr-150">
                <div class="col-12 col-12-medium"><h3>What I learned</h3></div>
                <div class="col-12 col-12-medium">
                    <p>
                        I ended up learning a lot from this project.
                        We started of by reading through the <a href="https://unity.com/resources/ultimate-guide-advanced-multiplayer-networking">Unity E-Book</a> which proved to be a great 
                        starting point as it taught us how to use Netcode for GameObjects, while also teaching general networking concepts and giving insight as to why things are done as they are.
                        When we switched over to Unity Transport, a lot of that knowledge was still relevant as when we were figuring out how to set things up, we at many times found that it just 
                        made sense to structure things in a similar fashion as to how Netcode for GameObjects does.
                        That isn't too strange considering that Unity Transport is the backbone of Netcode for GameObjects.
                    </p>
                    <p>
                        One would think that the work we did would feel a bit tiresome since we were essentially reinventing the wheel when Netcode for GameObjects already exists.
                        However, I found the process quite enjoyable as I still had questions lingering my mind as to why systems in Netcode for GameObject were set up the way they were.
                        Throughout the process, I would gradually find the answers to those questions as I probably encountered the same issues the people who made Netcode of GameObjects did.
                        It led to a lot of "aha" moments.
                    </p>
                    <p>
                        Back on track, what I believe has been of most value from this experience is that I've acclimated myself to network programming in a more general sense.
                        I would by no means consider myself an expert in the subject, but after having to work with a low-level library, I find that I've gotten to the point where 
                        I can understand and learn network associated concepts without too much difficulty.
                        After the project, I also decided to try and find out how some games do their networking to learn more.
                        Out of the sources I managed to find, the one I liked the most ended up being <a href="https://www.youtube.com/watch?v=Iryq1WA3bzw">GDC talk by Bungie</a> as it 
                        gave me introspective as to why a game might need its own networking solution rather than working with one of the streamlined models available within an engine.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/jquery.scrolly.min.js"></script>
<script src="assets/js/jquery.dropotron.min.js"></script>
<script src="assets/js/jquery.scrollex.min.js"></script>
<script src="assets/js/browser.min.js"></script>
<script src="assets/js/breakpoints.min.js"></script>
<script src="assets/js/util.js"></script>
<script src="assets/js/main.js"></script>

</body>
</html>